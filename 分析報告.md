# 專案管理系統 - Excel 分析報告

## 1. Excel 檔案概述

檔案名稱：【記入済み】プロジェクト計画書_人事.xlsx

這是一個日本公司的人事制度改善專案管理文件，包含三個工作表：

### 工作表結構

1. **プロジェクト計画書**（專案計劃書）- 53行 x 25列
2. **プロジェクト管理表**（專案管理表）- 52行 x 20列
3. **プロジェクト報告書**（專案報告書）- 91行 x 28列

---

## 2. 資料結構分析

### 2.1 プロジェクト計画書（專案計劃書）

#### 基本資訊區塊
- **新規作成日**：創建日期
- **新規作成者**：創建人
- **更新日**：更新日期
- **更新者**：更新人
- **顧客**：客戶名稱
- **プロジェクト名稱**：專案名稱
- **プロジェクト概要**：專案概述
- **プロジェクト区分**：專案類型（例：Needs-in(顧客起点)）
- **プロジェクトID**：專案編號（例：001-P-21-079）

#### 價值與目標
- **創出する価値**：專案創造的價值/客戶滿足度
- **問題解決**：要解決的問題
- **経験・体験**：提供的經驗/體驗

#### 財務資訊
- **売上**：銷售額（180000）
- **経費**：費用（0）
- **損益**：損益（売上 - 経費）
- **利益率**：利益率（損益/売上）

#### 時程資訊
- **プロジェクト開始予定日**：專案開始日期（2021-04-01）
- **プロジェクト終了予定日**：專案結束日期（2021-11-30）
- **プロジェクト期間**：專案期間（8個月）

#### 人員配置
- **PPM**（Project Portfolio Manager）：周娴 - 26工時
- **PMO**（Project Management Office）：- - 0工時
- **PD**（Project Director）：山崎 - 0工時
- **PM**（Project Manager）：沈庆元 - 96工時
- **CREW①**：王旭 - 96工時
- **CREW②-⑥**：未分配

#### 審查資訊
- **審查結果**
- **審査日**：審查日期
- **審査担当者**：審查負責人
- **特記事項**：特別備註

#### 其他
- **添付資料**：附加資料
- **組織力・生産性の向上**：組織能力提升相關記錄

---

### 2.2 プロジェクト管理表（專案管理表）

#### 任務管理（甘特圖格式）
- **タスク**：任務名稱
  - 資料確認・現状分析（84天）
  - 報告作成・中間報告（22天）
  - 報告修正・最終報告（24天）
  - 等級制度のアドバイス（28天）
  - 報酬制度のアドバイス（26天）
  - 評価制度のアドバイス（28天）

- **期間**：任務期間（天數）
- **担当**：負責人
- **時間軸**：2021-04 到 2022-03（每月一欄）
- **備考**：備註

#### 收支管理（按月）
- **①売上**（銷售額）
  - 計画：每月計劃收入
  - 実績：每月實際收入

- **②経費**（費用）
  - 計画：每月計劃支出
  - 実績：每月實際支出

- **③損益**（損益 = 売上 - 経費）
  - 計画：每月計劃損益
  - 実績：每月實際損益

- **④損益率**（損益率 = 損益/売上）
  - 計画：每月計劃損益率
  - 実績：每月實際損益率

#### 工時管理（按月）
按人員角色追蹤每月工時：
- **PPM**：周娴
- **PMO**
- **PD**：山崎
- **PM**：沈庆元
- **CREW①**：王旭
- **CREW②-⑥**

---

### 2.3 プロジェクト報告書（專案報告書）

與計劃書結構類似，但重點在「実績」（實際成果）：

- **項目對比**：預定 vs 實績
  - 売上：計劃 vs 實際
  - 経費：計劃 vs 實際
  - 損益：計劃 vs 實際
  - プロジェクト開始日：計劃 vs 實際
  - プロジェクト終了日：計劃 vs 實際

- **問題與學習**
  - プロジェクト推進で生じた問題：推進過程中發生的問題
  - 問題に対する改善策：問題改善對策
  - プロジェクトの反省・学び：專案反思與學習

- **顧客反饋**
  - お客様からの評価：客戶評價

---

## 3. 資料庫設計建議

### 3.1 核心資料表

#### 1. projects（專案主表）
```sql
CREATE TABLE projects (
  id SERIAL PRIMARY KEY,
  project_code VARCHAR(50) UNIQUE NOT NULL,      -- 專案編號
  project_name VARCHAR(255) NOT NULL,            -- 專案名稱
  client_name VARCHAR(255),                      -- 客戶名稱
  project_overview TEXT,                         -- 專案概述
  project_type VARCHAR(100),                     -- 專案類型

  -- 價值與目標
  value_proposition TEXT,                        -- 創造的價值
  problem_to_solve TEXT,                         -- 要解決的問題
  experience_provided TEXT,                      -- 提供的經驗

  -- 財務資訊
  planned_revenue DECIMAL(15, 2),               -- 計劃收入
  planned_expense DECIMAL(15, 2),               -- 計劃費用
  planned_profit DECIMAL(15, 2),                -- 計劃利潤
  planned_profit_rate DECIMAL(5, 4),            -- 計劃利潤率

  actual_revenue DECIMAL(15, 2),                -- 實際收入
  actual_expense DECIMAL(15, 2),                -- 實際費用
  actual_profit DECIMAL(15, 2),                 -- 實際利潤
  actual_profit_rate DECIMAL(5, 4),             -- 實際利潤率

  -- 時程資訊
  planned_start_date DATE,                      -- 計劃開始日期
  planned_end_date DATE,                        -- 計劃結束日期
  actual_start_date DATE,                       -- 實際開始日期
  actual_end_date DATE,                         -- 實際結束日期
  project_duration_months INTEGER,              -- 專案期間（月）

  -- 狀態
  status VARCHAR(50) DEFAULT 'planning',        -- 狀態：planning, in_progress, completed, cancelled

  -- 審查資訊
  review_result TEXT,                           -- 審查結果
  review_date DATE,                             -- 審查日期
  reviewer VARCHAR(100),                        -- 審查人
  review_notes TEXT,                            -- 審查備註

  -- 附件與備註
  attachments TEXT,                             -- 附件（JSON 或路徑）
  notes TEXT,                                   -- 備註

  -- 系統欄位
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  created_by VARCHAR(100),
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_by VARCHAR(100)
);
```

#### 2. project_members（專案成員）
```sql
CREATE TABLE project_members (
  id SERIAL PRIMARY KEY,
  project_id INTEGER REFERENCES projects(id) ON DELETE CASCADE,

  role VARCHAR(50) NOT NULL,                    -- PPM, PMO, PD, PM, CREW
  member_name VARCHAR(100),                     -- 成員姓名
  class_level VARCHAR(50),                      -- 等級/班級

  planned_hours DECIMAL(10, 2),                 -- 計劃工時
  actual_hours DECIMAL(10, 2),                  -- 實際工時

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

  UNIQUE(project_id, role, member_name)
);
```

#### 3. tasks（任務/工作項）
```sql
CREATE TABLE tasks (
  id SERIAL PRIMARY KEY,
  project_id INTEGER REFERENCES projects(id) ON DELETE CASCADE,

  task_name VARCHAR(255) NOT NULL,              -- 任務名稱
  description TEXT,                             -- 任務描述
  assigned_to VARCHAR(100),                     -- 負責人

  planned_duration INTEGER,                     -- 計劃天數
  actual_duration INTEGER,                      -- 實際天數

  planned_start_date DATE,                      -- 計劃開始日期
  planned_end_date DATE,                        -- 計劃結束日期
  actual_start_date DATE,                       -- 實際開始日期
  actual_end_date DATE,                         -- 實際結束日期

  status VARCHAR(50) DEFAULT 'pending',         -- pending, in_progress, completed, cancelled
  progress INTEGER DEFAULT 0,                   -- 進度百分比 (0-100)

  notes TEXT,                                   -- 備註

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 4. monthly_financials（月度財務）
```sql
CREATE TABLE monthly_financials (
  id SERIAL PRIMARY KEY,
  project_id INTEGER REFERENCES projects(id) ON DELETE CASCADE,

  year_month DATE NOT NULL,                     -- 年月 (YYYY-MM-01)

  -- 計劃數據
  planned_revenue DECIMAL(15, 2),               -- 計劃收入
  planned_expense DECIMAL(15, 2),               -- 計劃支出
  planned_profit DECIMAL(15, 2),                -- 計劃利潤
  planned_profit_rate DECIMAL(5, 4),            -- 計劃利潤率

  -- 實際數據
  actual_revenue DECIMAL(15, 2),                -- 實際收入
  actual_expense DECIMAL(15, 2),                -- 實際支出
  actual_profit DECIMAL(15, 2),                 -- 實際利潤
  actual_profit_rate DECIMAL(5, 4),             -- 實際利潤率

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

  UNIQUE(project_id, year_month)
);
```

#### 5. monthly_hours（月度工時）
```sql
CREATE TABLE monthly_hours (
  id SERIAL PRIMARY KEY,
  project_id INTEGER REFERENCES projects(id) ON DELETE CASCADE,
  member_id INTEGER REFERENCES project_members(id) ON DELETE CASCADE,

  year_month DATE NOT NULL,                     -- 年月

  planned_hours DECIMAL(10, 2),                 -- 計劃工時
  actual_hours DECIMAL(10, 2),                  -- 實際工時

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

  UNIQUE(project_id, member_id, year_month)
);
```

#### 6. project_reports（專案報告）
```sql
CREATE TABLE project_reports (
  id SERIAL PRIMARY KEY,
  project_id INTEGER REFERENCES projects(id) ON DELETE CASCADE,

  report_type VARCHAR(50),                      -- planning, interim, final

  -- 創造的價值
  value_created TEXT,                           -- 專案創造的價值

  -- 問題與改善
  problems_encountered TEXT,                    -- 遇到的問題
  improvement_measures TEXT,                    -- 改善措施
  lessons_learned TEXT,                         -- 學到的教訓

  -- 客戶反饋
  customer_feedback TEXT,                       -- 客戶評價
  customer_satisfaction INTEGER,                -- 客戶滿意度 (1-5)

  -- 組織能力提升
  organizational_improvement TEXT,              -- 組織能力提升

  report_date DATE,                             -- 報告日期

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  created_by VARCHAR(100),
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_by VARCHAR(100)
);
```

#### 7. gantt_timeline（甘特圖時間軸）
```sql
CREATE TABLE gantt_timeline (
  id SERIAL PRIMARY KEY,
  task_id INTEGER REFERENCES tasks(id) ON DELETE CASCADE,

  year_month DATE NOT NULL,                     -- 年月
  is_planned BOOLEAN DEFAULT TRUE,              -- 是否為計劃
  is_active BOOLEAN DEFAULT FALSE,              -- 該月是否有活動
  completion_percentage INTEGER DEFAULT 0,       -- 該月完成百分比

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

  UNIQUE(task_id, year_month, is_planned)
);
```

### 3.2 資料庫索引建議

```sql
-- projects 表索引
CREATE INDEX idx_projects_code ON projects(project_code);
CREATE INDEX idx_projects_status ON projects(status);
CREATE INDEX idx_projects_dates ON projects(planned_start_date, planned_end_date);
CREATE INDEX idx_projects_client ON projects(client_name);

-- project_members 表索引
CREATE INDEX idx_members_project ON project_members(project_id);
CREATE INDEX idx_members_role ON project_members(role);

-- tasks 表索引
CREATE INDEX idx_tasks_project ON tasks(project_id);
CREATE INDEX idx_tasks_status ON tasks(status);
CREATE INDEX idx_tasks_assigned ON tasks(assigned_to);

-- monthly_financials 表索引
CREATE INDEX idx_financials_project_month ON monthly_financials(project_id, year_month);

-- monthly_hours 表索引
CREATE INDEX idx_hours_project_month ON monthly_hours(project_id, year_month);
CREATE INDEX idx_hours_member ON monthly_hours(member_id);
```

---

## 4. 網頁版功能建議

### 4.1 核心模組

#### 1. 專案管理模組
- 專案列表（支援篩選、排序、搜尋）
- 專案詳情頁面
- 專案新增/編輯/刪除
- 專案狀態追蹤
- 專案複製功能

#### 2. 任務管理模組
- 甘特圖視圖（拖拽調整時間）
- 任務列表視圖
- 任務看板視圖（Kanban）
- 任務新增/編輯/刪除
- 任務進度更新
- 任務依賴關係管理

#### 3. 財務管理模組
- 預算規劃
- 月度收支管理
- 實際 vs 計劃對比圖表
- 利潤率分析
- 財務報表匯出

#### 4. 人力資源模組
- 成員管理
- 角色分配
- 工時規劃與記錄
- 工時統計與報表
- 資源利用率分析

#### 5. 報告模組
- 專案計劃書生成
- 專案報告書生成
- 進度報告
- 客戶反饋記錄
- 報告匯出（PDF/Excel）

#### 6. 儀表板
- 專案概覽
- 關鍵指標（KPI）
- 收支趨勢圖
- 任務完成率
- 資源使用情況
- 專案時間軸

### 4.2 進階功能

#### 1. 權限管理
- 角色權限設定（管理員、PM、成員、只讀）
- 資料訪問控制
- 操作日誌

#### 2. 通知系統
- 任務到期提醒
- 專案里程碑通知
- 預算超支警告
- 審查通知

#### 3. 協作功能
- 評論與討論
- 文件附件上傳
- 活動時間線
- @提及功能

#### 4. 資料導入/匯出
- Excel 匯入（支援原格式）
- Excel 匯出
- PDF 報告匯出
- 資料備份還原

#### 5. 多語言支援
- 繁體中文
- 簡體中文
- 日文
- 英文

---

## 5. 技術堆疊建議

### 5.1 後端技術

#### 選項 A：Node.js + Express
```javascript
技術棧：
- Runtime: Node.js 18+
- Framework: Express.js
- ORM: Sequelize / Prisma
- Database: PostgreSQL 14+
- Authentication: JWT + bcrypt
- File Upload: Multer
- Excel Processing: xlsx / exceljs
- PDF Generation: pdfkit / puppeteer
```

優點：
- JavaScript 全棧開發
- 生態系統豐富
- 非同步處理優秀
- Excel 處理庫成熟

#### 選項 B：Python + FastAPI
```python
技術棧：
- Runtime: Python 3.10+
- Framework: FastAPI
- ORM: SQLAlchemy / Tortoise ORM
- Database: PostgreSQL 14+
- Authentication: JWT + passlib
- Excel Processing: openpyxl / pandas
- PDF Generation: reportlab / weasyprint
```

優點：
- 資料處理能力強
- pandas 處理 Excel 優秀
- 類型提示
- 自動生成 API 文檔

#### 選項 C：Java + Spring Boot
```java
技術棧：
- Runtime: Java 17+
- Framework: Spring Boot 3.x
- ORM: Spring Data JPA / MyBatis
- Database: PostgreSQL 14+
- Authentication: Spring Security + JWT
- Excel Processing: Apache POI / EasyExcel
- PDF Generation: iText / Flying Saucer
```

優點：
- 企業級應用成熟
- 性能優秀
- 生態系統完整
- 適合大型團隊

### 5.2 前端技術

#### 選項 A：React + TypeScript
```javascript
技術棧：
- Framework: React 18+
- Language: TypeScript
- State Management: Redux Toolkit / Zustand
- UI Library: Ant Design / Material-UI
- Charts: ECharts / Recharts
- Gantt: dhtmlx-gantt / frappe-gantt
- Date: dayjs
- HTTP Client: axios
- Build Tool: Vite
```

#### 選項 B：Vue 3 + TypeScript
```javascript
技術棧：
- Framework: Vue 3
- Language: TypeScript
- State Management: Pinia
- UI Library: Element Plus / Vuetify
- Charts: ECharts / Chart.js
- Gantt: vue-ganttastic / gantt-schedule-timeline-calendar
- Date: dayjs
- HTTP Client: axios
- Build Tool: Vite
```

#### 選項 C：Next.js（全棧方案）
```javascript
技術棧：
- Framework: Next.js 14+ (App Router)
- Language: TypeScript
- State Management: Zustand / React Context
- UI Library: shadcn/ui + Tailwind CSS
- Database: Prisma ORM
- Charts: Recharts / Tremor
- Authentication: NextAuth.js
```

### 5.3 資料庫

**推薦：PostgreSQL 14+**

理由：
- 開源免費
- 支援複雜查詢
- JSON 資料類型支援
- 豐富的索引類型
- 優秀的並發處理
- 支援全文搜索
- 成熟的生態系統

### 5.4 部署方案

#### 選項 A：容器化部署
```yaml
技術：
- Container: Docker
- Orchestration: Docker Compose / Kubernetes
- Reverse Proxy: Nginx
- CI/CD: GitHub Actions / GitLab CI
```

#### 選項 B：雲端部署
```
平台選擇：
- AWS: EC2 + RDS + S3
- GCP: Cloud Run + Cloud SQL
- Azure: App Service + Azure Database
- Vercel (前端) + Railway/Render (後端)
```

---

## 6. 開發路線圖建議

### Phase 1：基礎功能（2-3個月）
1. 資料庫設計與建立
2. 後端 API 開發
   - 用戶認證
   - 專案 CRUD
   - 任務 CRUD
3. 前端基礎頁面
   - 登入/註冊
   - 專案列表
   - 專案詳情
   - 任務管理

### Phase 2：核心功能（2-3個月）
1. 甘特圖實現
2. 財務管理功能
3. 人力資源管理
4. 儀表板開發
5. 報表功能

### Phase 3：進階功能（1-2個月）
1. Excel 導入/匯出
2. PDF 報告生成
3. 通知系統
4. 權限管理
5. 多語言支援

### Phase 4：優化與部署（1個月）
1. 性能優化
2. UI/UX 優化
3. 測試完善
4. 部署上線
5. 文檔編寫

---

## 7. 預估成本

### 開發成本（以台灣為例）
- 1名全端工程師：6個月 x 8-12萬/月 = 48-72萬
- 或 1名前端 + 1名後端：4個月 x (8萬+8萬)/月 = 64萬

### 運營成本（月）
- 雲端主機：2,000 - 5,000元
- 資料庫：1,000 - 3,000元
- 儲存空間：500 - 1,000元
- CDN：500 - 1,000元
- 域名 + SSL：100 - 500元
- **總計：約 4,000 - 10,000元/月**

---

## 8. 風險與建議

### 風險
1. Excel 格式複雜，導入邏輯可能複雜
2. 甘特圖互動功能開發難度較高
3. 多語言支援需要額外資源
4. 資料遷移可能遇到問題

### 建議
1. **先做 MVP**：優先實現核心功能
2. **敏捷開發**：分階段交付，快速驗證
3. **用戶反饋**：早期讓用戶參與測試
4. **技術選型**：根據團隊技術棧選擇
5. **開源優先**：優先使用成熟的開源組件
6. **重視 UX**：專案管理系統的易用性很重要
7. **資料安全**：做好備份和權限控制

---

## 下一步行動

1. **需求確認**
   - 確認使用者角色和權限
   - 確認必要功能優先級
   - 確認預算和時程

2. **技術選型**
   - 根據團隊現有技術棧決定
   - 評估學習成本
   - POC (Proof of Concept) 驗證

3. **原型設計**
   - UI/UX 設計
   - 流程圖設計
   - 資料庫最終確認

4. **開發啟動**
   - 建立開發環境
   - 初始化專案
   - 開始編碼

---

您想要我協助您進行下一步嗎？例如：
1. 生成資料庫建立腳本
2. 設計 REST API 規格
3. 建立專案初始架構
4. 其他具體需求
